{% extends 'todo/base.html' %} {% load static %} {% block content %}
<style>
  .task-row {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .task-row:hover {
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .status-badge {
    animation: fadeIn 0.5s ease-in;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .action-btn {
    transition: all 0.2s ease;
  }

  .action-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .empty-state {
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  .task-card {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .task-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }

  .search-input:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.1);
  }
</style>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
  <!-- Header Section -->
  <div
    class="bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 rounded-2xl sm:rounded-3xl shadow-2xl p-6 sm:p-8 mb-6 sm:mb-8 relative overflow-hidden"
  >
    <div class="absolute inset-0 opacity-20">
      <div
        class="absolute top-0 right-0 w-40 h-40 sm:w-64 sm:h-64 bg-white rounded-full filter blur-3xl"
      ></div>
      <div
        class="absolute bottom-0 left-0 w-40 h-40 sm:w-64 sm:h-64 bg-pink-300 rounded-full filter blur-3xl"
      ></div>
    </div>

    <div
      class="relative z-10 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"
    >
      <div>
        <h1 class="text-2xl sm:text-3xl lg:text-4xl font-black text-white mb-2">
          üìù Mes T√¢ches
        </h1>
        <p class="text-white/80 text-xs sm:text-sm">
          G√©rez vos t√¢ches quotidiennes avec efficacit√©
        </p>
      </div>

      <a
        href="{% url 'list_create' %}"
        class="action-btn w-full sm:w-auto px-6 py-3 bg-white text-purple-700 hover:bg-gradient-to-r hover:from-white hover:to-purple-50 rounded-xl font-bold transition shadow-xl flex items-center justify-center gap-2"
      >
        <span class="text-xl">‚ûï</span>
        <span>Ajouter une t√¢che</span>
      </a>
    </div>
  </div>

  <!-- Stats Cards -->
  <div
    class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8"
  >
    <div
      class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl sm:rounded-2xl p-5 sm:p-6 text-white shadow-lg"
    >
      <div class="flex items-center justify-between">
        <div>
          <p class="text-blue-100 text-xs sm:text-sm font-medium mb-1">Total</p>
          <p class="text-2xl sm:text-3xl font-black">{{ total_tasks }}</p>
        </div>
        <div
          class="w-12 h-12 sm:w-16 sm:h-16 bg-white/20 rounded-xl sm:rounded-2xl flex items-center justify-center text-2xl sm:text-3xl"
        >
          üìã
        </div>
      </div>
    </div>

    <div
      class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl sm:rounded-2xl p-5 sm:p-6 text-white shadow-lg"
    >
      <div class="flex items-center justify-between">
        <div>
          <p class="text-green-100 text-xs sm:text-sm font-medium mb-1">
            Termin√©es
          </p>
          <p class="text-2xl sm:text-3xl font-black">{{ completed_tasks }}</p>
        </div>
        <div
          class="w-12 h-12 sm:w-16 sm:h-16 bg-white/20 rounded-xl sm:rounded-2xl flex items-center justify-center text-2xl sm:text-3xl"
        >
          ‚úÖ
        </div>
      </div>
    </div>

    <div
      class="bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl sm:rounded-2xl p-5 sm:p-6 text-white shadow-lg sm:col-span-2 lg:col-span-1"
    >
      <div class="flex items-center justify-between">
        <div>
          <p class="text-yellow-100 text-xs sm:text-sm font-medium mb-1">
            En cours
          </p>
          <p class="text-2xl sm:text-3xl font-black">{{ pending_tasks }}</p>
        </div>
        <div
          class="w-12 h-12 sm:w-16 sm:h-16 bg-white/20 rounded-xl sm:rounded-2xl flex items-center justify-center text-2xl sm:text-3xl"
        >
          ‚è≥
        </div>
      </div>
    </div>
  </div>

  <!-- Search Section - Am√©lior√© -->
  <div class="bg-white rounded-2xl shadow-xl p-6 mb-6 sm:mb-8">
    <form method="GET" class="flex flex-col sm:flex-row gap-4 items-start sm:items-end">
      {% csrf_token %}
      
      <div class="flex-1 w-full">
        <label for="recherche" class="block text-sm font-bold text-slate-700 mb-2">
          üîç Rechercher une t√¢che
        </label>
        <div class="relative">
          <input 
            type="search" 
            name="recherche" 
            id="recherche"
            placeholder="Tapez le titre ou la description d'une t√¢che..." 
            value="{{ query }}"
            class="search-input w-full px-4 py-3 pl-12 border-2 border-slate-200 rounded-xl focus:border-purple-500 transition-all duration-200 text-slate-700 placeholder-slate-400"
          />
          <span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 text-xl">
            üîé
          </span>
        </div>
      </div>
      
      <button 
        type="submit"
        class="action-btn w-full sm:w-auto px-8 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-xl font-bold transition shadow-lg flex items-center justify-center gap-2"
      >
        <span>üîç</span>
        <span>Rechercher</span>
      </button>
      
      {% if query %}
      <a 
        href="{% url 'list_task' %}"
        class="action-btn w-full sm:w-auto px-6 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-xl font-semibold transition shadow-md flex items-center justify-center gap-2"
      >
        <span>‚úï</span>
        <span>Effacer</span>
      </a>
      {% endif %}
    </form>
    
    {% if query %}
    <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
      <p class="text-sm text-blue-800">
        <span class="font-semibold">Recherche active :</span> "{{ query }}"
      </p>
    </div>
    {% endif %}
  </div>

  <!-- Tasks Table (Desktop) -->
  <div class="hidden lg:block bg-white rounded-2xl shadow-xl overflow-hidden">
    <div class="overflow-x-auto">
      <table class="min-w-full">
        <thead>
          <tr class="bg-gradient-to-r from-slate-800 to-slate-900 text-white">
            <th
              class="px-6 py-4 text-left text-sm font-bold uppercase tracking-wider"
            >
              Titre
            </th>
            <th
              class="px-6 py-4 text-left text-sm font-bold uppercase tracking-wider"
            >
              Description
            </th>
            <th
              class="px-6 py-4 text-left text-sm font-bold uppercase tracking-wider"
            >
              Date de cr√©ation
            </th>
            <th
              class="px-6 py-4 text-left text-sm font-bold uppercase tracking-wider"
            >
              Statut
            </th>
            <th
              class="px-6 py-4 text-left text-sm font-bold uppercase tracking-wider"
            >
              Actions
            </th>
          </tr>
        </thead>

        <tbody class="divide-y divide-slate-100">
          {% for task in tasks %}
          <tr
            class="task-row bg-white hover:bg-gradient-to-r hover:from-slate-50 hover:to-blue-50"
          >
            <td class="px-6 py-4">
              <div class="flex items-center gap-3">
                <div
                  class="w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-xl flex items-center justify-center text-white font-bold shadow-md"
                >
                  {{ task.titre|first|upper }}
                </div>
                <span class="font-semibold text-slate-800"
                  >{{ task.titre }}</span
                >
              </div>
            </td>

            <td class="px-6 py-4 text-slate-600">
              {{ task.description|truncatewords:10 }}
            </td>

            <td class="px-6 py-4 text-slate-500 text-sm">
              <div class="flex items-center gap-2">
                <span>üìÖ</span>
                <span>{{ task.date_creation|date:"d/m/Y" }}</span>
              </div>
            </td>

            <td class="px-6 py-4">
              {% if task.completed %}
              <span
                class="status-badge inline-flex items-center gap-1 px-3 py-1.5 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-full text-xs font-bold shadow-md"
              >
                <span>‚úì</span>
                <span>Termin√©e</span>
              </span>
              {% else %}
              <span
                class="status-badge inline-flex items-center gap-1 px-3 py-1.5 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-full text-xs font-bold shadow-md"
              >
                <span>‚è≥</span>
                <span>En cours</span>
              </span>
              {% endif %}
            </td>

            <td class="px-6 py-4">
              <div class="flex gap-2">
                <a
                  href="{% url 'list_update' task.id %}"
                  class="action-btn px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg text-sm font-semibold shadow-md"
                  title="Modifier"
                >
                  ‚úèÔ∏è
                </a>

                <a
                  href="{% url 'delete_task' task.id %}"
                  class="action-btn px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-lg text-sm font-semibold shadow-md"
                  title="Supprimer"
                >
                  üóëÔ∏è
                </a>

                {% if not task.completed %}
                <a
                  href="{% url 'completed_task' task.id %}"
                  class="action-btn px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-lg text-sm font-semibold shadow-md"
                  title="Marquer comme termin√©e"
                >
                  ‚úì
                </a>
                {% else %}
                <a
                  href="{% url 'nocompleted_task' task.id %}"
                  class="action-btn px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white rounded-lg text-sm font-semibold shadow-md"
                  title="Marquer comme non termin√©e"
                >
                  <span>‚Ü∫</span>
                </a>
                {% endif %}
              </div>
            </td>
          </tr>

          {% empty %}
          <tr>
            <td colspan="5" class="px-6 py-16">
              <div class="text-center empty-state">
                <div class="inline-block mb-4">
                  <div
                    class="w-24 h-24 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center text-5xl"
                  >
                    üì≠
                  </div>
                </div>
                <h3 class="text-xl font-bold text-slate-700 mb-2">
                  {% if query %}
                  Aucune t√¢che trouv√©e pour "{{ query }}"
                  {% else %}
                  Aucune t√¢che pour le moment
                  {% endif %}
                </h3>
                <p class="text-slate-500 mb-6">
                  {% if query %}
                  Essayez avec d'autres mots-cl√©s ou cr√©ez une nouvelle t√¢che.
                  {% else %}
                  Commencez par cr√©er votre premi√®re t√¢che !
                  {% endif %}
                </p>
                <a
                  href="{% url 'list_create' %}"
                  class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-xl font-bold transition shadow-lg"
                >
                  <span class="text-xl">‚ûï</span>
                  <span>Cr√©er une nouvelle t√¢che</span>
                </a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Tasks Cards (Mobile & Tablet) -->
  <div class="lg:hidden space-y-4">
    {% for task in tasks %}
    <div
      class="task-card bg-white rounded-xl shadow-lg overflow-hidden border border-slate-100"
    >
      <!-- Card Header -->
      <div
        class="bg-gradient-to-r from-purple-500 to-blue-500 px-4 py-3 flex items-center justify-between"
      >
        <div class="flex items-center gap-3">
          <div
            class="w-10 h-10 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center text-white font-bold text-lg shadow-md"
          >
            {{ task.titre|first|upper }}
          </div>
          <h3 class="font-bold text-white text-base sm:text-lg">
            {{ task.titre }}
          </h3>
        </div>

        {% if task.completed %}
        <span
          class="status-badge inline-flex items-center gap-1 px-2.5 py-1 bg-green-500 text-white rounded-full text-xs font-bold shadow-md"
        >
          <span>‚úì</span>
          <span class="hidden sm:inline">Termin√©e</span>
        </span>
        {% else %}
        <span
          class="status-badge inline-flex items-center gap-1 px-2.5 py-1 bg-yellow-500 text-white rounded-full text-xs font-bold shadow-md"
        >
          <span>‚è≥</span>
          <span class="hidden sm:inline">En cours</span>
        </span>
        {% endif %}
      </div>

      <!-- Card Body -->
      <div class="p-4 space-y-3">
        <div>
          <p class="text-xs font-semibold text-slate-500 mb-1">Description</p>
          <p class="text-sm text-slate-700">
            {{ task.description|truncatewords:15 }}
          </p>
        </div>

        <div class="flex items-center gap-2 text-xs text-slate-500">
          <span>üìÖ</span>
          <span>Cr√©√©e le {{ task.date_creation|date:"d/m/Y" }}</span>
        </div>

        <!-- Actions -->
        <div class="grid grid-cols-3 gap-2 pt-2 border-t border-slate-100">
          <a
            href="{% url 'list_update' task.id %}"
            class="action-btn px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg text-xs sm:text-sm font-semibold shadow-md text-center"
            title="Modifier"
          >
            <span class="block sm:hidden">‚úèÔ∏è</span>
            <span class="hidden sm:block">‚úèÔ∏è Modifier</span>
          </a>

          <a
            href="{% url 'delete_task' task.id %}"
            class="action-btn px-3 py-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-lg text-xs sm:text-sm font-semibold shadow-md text-center"
            title="Supprimer"
          >
            <span class="block sm:hidden">üóëÔ∏è</span>
            <span class="hidden sm:block">üóëÔ∏è Supprimer</span>
          </a>

          {% if not task.completed %}
          <a
            href="{% url 'completed_task' task.id %}"
            class="action-btn px-3 py-2 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-lg text-xs sm:text-sm font-semibold shadow-md text-center"
            title="Terminer"
          >
            <span class="block sm:hidden">‚úì</span>
            <span class="hidden sm:block">‚úì Terminer</span>
          </a>
          {% else %}
          <a
            href="{% url 'nocompleted_task' task.id %}"
            class="action-btn px-3 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white rounded-lg text-xs sm:text-sm font-semibold shadow-md text-center"
            title="Restaurer"
          >
            <span class="block sm:hidden">‚Ü∫</span>
            <span class="hidden sm:block">‚Ü∫ Restaurer</span>
          </a>
          {% endif %}
        </div>
      </div>
    </div>

    {% empty %}
    <div class="bg-white rounded-xl shadow-lg p-8 text-center empty-state">
      <div class="inline-block mb-4">
        <div
          class="w-20 h-20 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center text-4xl"
        >
          üì≠
        </div>
      </div>
      <h3 class="text-lg font-bold text-slate-700 mb-2">
        {% if query %}
        Aucune t√¢che trouv√©e pour "{{ query }}"
        {% else %}
        Aucune t√¢che pour le moment
        {% endif %}
      </h3>
      <p class="text-sm text-slate-500 mb-6">
        {% if query %}
        Essayez avec d'autres mots-cl√©s ou cr√©ez une nouvelle t√¢che.
        {% else %}
        Commencez par cr√©er votre premi√®re t√¢che !
        {% endif %}
      </p>
      <a
        href="{% url 'list_create' %}"
        class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-xl font-bold transition shadow-lg"
      >
        <span class="text-xl">‚ûï</span>
        <span>Cr√©er une nouvelle t√¢che</span>
      </a>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}